{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\thang\\\\Code_WDP301\\\\Learning-Management-System\\\\frontend\\\\src\\\\components\\\\Student\\\\QuizList.jsx\",\n  _s = $RefreshSig$();\n// src/components/QuizList.jsx\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { motion } from \"framer-motion\";\nimport { FiArrowLeft, FiClock, FiCheckCircle, FiAlertTriangle, FiEdit3, FiSend } from \"react-icons/fi\";\nimport { Container, Card, Button, Spinner, Form, Row, Col, Badge, Alert, ProgressBar } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function QuizList() {\n  _s();\n  var _submission$grade3;\n  const navigate = useNavigate();\n  const {\n    assignmentId\n  } = useParams(); // Route: /student/quiz/:assignmentId\n\n  // 1. State\n  const [assignment, setAssignment] = useState(null);\n  const [submission, setSubmission] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [answers, setAnswers] = useState({}); // { questionId: selectedOption }\n  const [essayContent, setEssayContent] = useState(\"\");\n  const [canEdit, setCanEdit] = useState(false); // còn hạn nộp\n  const [hasSubmitted, setHasSubmitted] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Lấy studentId từ localStorage hoặc mặc định\n  const DEFAULT_STUDENT_ID = \"60a000000000000000000002\";\n  const [studentId, setStudentId] = useState(DEFAULT_STUDENT_ID);\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(\"user\");\n      if (stored) {\n        const u = JSON.parse(stored);\n        if (u && u._id) setStudentId(u._id);\n      }\n    } catch (e) {\n      console.warn(\"localStorage user parse error:\", e);\n    }\n  }, []);\n\n  // Fetch assignment detail\n  const fetchAssignment = useCallback(async () => {\n    try {\n      const resp = await axios.get(`/api/student/assignments/${assignmentId}`);\n      if (resp.data.success) {\n        setAssignment(resp.data.data);\n      }\n    } catch (err) {\n      console.error(\"Error fetching assignment:\", err);\n    }\n  }, [assignmentId]);\n\n  // Fetch submission (if có) for this student\n  const fetchSubmission = useCallback(async () => {\n    try {\n      // FIX: Sử dụng đúng endpoint như bạn đã chỉ định\n      const resp = await axios.get(`/api/student/submissions/assignment/${assignmentId}`);\n      if (resp.data.success) {\n        // Lọc ra submission đúng studentId\n        const allSubs = resp.data.data;\n        const mySub = allSubs.find(s => s.studentId.toString() === studentId);\n        if (mySub) {\n          setSubmission(mySub);\n          setHasSubmitted(true);\n          // Nếu quiz:\n          if ((assignment === null || assignment === void 0 ? void 0 : assignment.type) === \"quiz\" && mySub.answers) {\n            const ansMap = {};\n            mySub.answers.forEach(ans => {\n              ansMap[ans.questionId] = ans.selectedOption;\n            });\n            setAnswers(ansMap);\n          }\n          // Nếu essay:\n          if ((assignment === null || assignment === void 0 ? void 0 : assignment.type) === \"essay\" && mySub.content) {\n            setEssayContent(mySub.content);\n          }\n        } else {\n          // Không tìm thấy submission -> reset state\n          setSubmission(null);\n          setHasSubmitted(false);\n          setAnswers({});\n          setEssayContent(\"\");\n        }\n      }\n    } catch (err) {\n      console.error(\"Error fetching submission:\", err);\n      // Nếu lỗi 404 hoặc không tìm thấy -> reset state\n      setSubmission(null);\n      setHasSubmitted(false);\n      setAnswers({});\n      setEssayContent(\"\");\n    }\n  }, [assignmentId, studentId, assignment === null || assignment === void 0 ? void 0 : assignment.type]);\n\n  // Kiểm tra hạn nộp\n  const checkCanEdit = useCallback(() => {\n    if (!assignment) return;\n    const now = new Date();\n    const due = new Date(assignment.dueDate);\n    // Nếu chưa quá hạn -> có thể nộp hoặc resubmit\n    setCanEdit(now <= due);\n  }, [assignment]);\n\n  // Kết hợp fetch và kiểm tra\n  useEffect(() => {\n    async function loadData() {\n      setIsLoading(true);\n      await fetchAssignment();\n      setIsLoading(false);\n    }\n    loadData();\n  }, [fetchAssignment]);\n  useEffect(() => {\n    if (assignment && studentId) {\n      checkCanEdit();\n      fetchSubmission();\n    }\n  }, [assignment, studentId, fetchSubmission, checkCanEdit]);\n\n  // Handle chọn đáp án quiz\n  const handleOptionChange = (questionId, optionKey) => {\n    if (!canEdit) return;\n    setAnswers(prev => ({\n      ...prev,\n      [questionId]: optionKey\n    }));\n  };\n\n  // Handle submit/resubmit\n  const handleSubmit = async () => {\n    if (!assignment || !studentId) return;\n\n    // Kiểm tra deadline một lần nữa\n    const now = new Date();\n    const due = new Date(assignment.dueDate);\n    if (now > due) {\n      alert(\"Deadline has passed. Cannot submit.\");\n      return;\n    }\n\n    // Validation cho quiz\n    if (assignment.type === \"quiz\") {\n      const totalQuestions = assignment.questions.length;\n      const answeredQuestions = Object.keys(answers).length;\n      if (answeredQuestions === 0) {\n        alert(\"Please answer at least one question before submitting.\");\n        return;\n      }\n      // Optional: require all questions to be answered\n      // if (answeredQuestions < totalQuestions) {\n      //   const confirm = window.confirm(`You have only answered ${answeredQuestions}/${totalQuestions} questions. Submit anyway?`);\n      //   if (!confirm) return;\n      // }\n    }\n\n    // Validation cho essay\n    if (assignment.type === \"essay\" && !essayContent.trim()) {\n      alert(\"Please write your answer before submitting.\");\n      return;\n    }\n    setIsSubmitting(true);\n    try {\n      if (hasSubmitted && submission && submission._id) {\n        // RESUBMIT - Update existing submission\n        let resubmitPayload = {};\n        if (assignment.type === \"quiz\") {\n          // Chuyển answers thành mảng\n          const ansArr = Object.entries(answers).map(([qId, sel]) => ({\n            questionId: qId,\n            selectedOption: sel\n          }));\n          resubmitPayload.answers = ansArr;\n        } else {\n          // essay\n          resubmitPayload.content = essayContent.trim();\n        }\n        console.log(\"Resubmitting with payload:\", resubmitPayload);\n        console.log(\"Submission ID:\", submission._id);\n\n        // FIX: Sử dụng đúng endpoint resubmit\n        const response = await axios.put(`/api/student/submissions/resubmit/${submission._id}`, resubmitPayload);\n        console.log(\"Resubmit response:\", response.data);\n        if (response.data.success) {\n          alert(\"Resubmission successful!\");\n          // Refresh lại submission để lấy dữ liệu mới\n          await fetchSubmission();\n        } else {\n          alert(response.data.message || \"Resubmission failed!\");\n        }\n      } else {\n        // NEW SUBMISSION - Create new submission\n        let payload = {\n          studentId,\n          assignmentId\n        };\n        if (assignment.type === \"quiz\") {\n          // Chuyển answers thành mảng\n          const ansArr = Object.entries(answers).map(([qId, sel]) => ({\n            questionId: qId,\n            selectedOption: sel\n          }));\n          payload.answers = ansArr;\n        } else {\n          // essay\n          payload.content = essayContent.trim();\n        }\n        console.log(\"New submission with payload:\", payload);\n        const response = await axios.post(\"/api/student/submissions/submit\", payload);\n        console.log(\"Submit response:\", response.data);\n        if (response.data.success) {\n          alert(\"Submission successful!\");\n          // Set hasSubmitted và submission data\n          setHasSubmitted(true);\n          if (response.data.data) {\n            setSubmission(response.data.data);\n          }\n          // Refresh lại submission để đảm bảo\n          await fetchSubmission();\n        } else {\n          alert(response.data.message || \"Submission failed!\");\n        }\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"Submit error:\", err);\n      const errorMsg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message || \"Failed to submit.\";\n      alert(errorMsg);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Helper functions\n  const getTimeRemaining = () => {\n    if (!assignment) return null;\n    const now = new Date();\n    const due = new Date(assignment.dueDate);\n    const diff = due - now;\n    if (diff <= 0) return \"Overdue\";\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n    const hours = Math.floor(diff % (1000 * 60 * 60 * 24) / (1000 * 60 * 60));\n    if (days > 0) return `${days} day${days > 1 ? 's' : ''} remaining`;\n    if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} remaining`;\n    return \"Less than 1 hour remaining\";\n  };\n  const getQuizProgress = () => {\n    if (!assignment || assignment.type !== 'quiz') return 0;\n    const totalQuestions = assignment.questions.length;\n    const answeredQuestions = Object.keys(answers).length;\n    return totalQuestions > 0 ? answeredQuestions / totalQuestions * 100 : 0;\n  };\n  const getStatusBadge = () => {\n    var _submission$grade;\n    if (hasSubmitted && (submission === null || submission === void 0 ? void 0 : (_submission$grade = submission.grade) === null || _submission$grade === void 0 ? void 0 : _submission$grade.score) != null) {\n      return /*#__PURE__*/_jsxDEV(Badge, {\n        bg: \"success\",\n        className: \"ms-2\",\n        children: [/*#__PURE__*/_jsxDEV(FiCheckCircle, {\n          className: \"me-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 51\n        }, this), \"Graded\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 14\n      }, this);\n    }\n    if (hasSubmitted) {\n      return /*#__PURE__*/_jsxDEV(Badge, {\n        bg: \"info\",\n        className: \"ms-2\",\n        children: [/*#__PURE__*/_jsxDEV(FiCheckCircle, {\n          className: \"me-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 48\n        }, this), \"Submitted\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 14\n      }, this);\n    }\n    if (!canEdit) {\n      return /*#__PURE__*/_jsxDEV(Badge, {\n        bg: \"danger\",\n        className: \"ms-2\",\n        children: [/*#__PURE__*/_jsxDEV(FiAlertTriangle, {\n          className: \"me-1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 50\n        }, this), \"Overdue\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 14\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(Badge, {\n      bg: \"warning\",\n      className: \"ms-2\",\n      children: [/*#__PURE__*/_jsxDEV(FiClock, {\n        className: \"me-1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 49\n      }, this), \"In Progress\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 12\n    }, this);\n  };\n\n  // Show last submission info\n  const getSubmissionInfo = () => {\n    var _submission$grade2;\n    if (!hasSubmitted || !submission) return null;\n    return /*#__PURE__*/_jsxDEV(Alert, {\n      variant: \"info\",\n      className: \"mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-between align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Last submitted:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), \" \", new Date(submission.submittedAt).toLocaleString(), ((_submission$grade2 = submission.grade) === null || _submission$grade2 === void 0 ? void 0 : _submission$grade2.score) != null && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ms-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Grade:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 17\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-success\",\n              children: [submission.grade.score, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this), canEdit && /*#__PURE__*/_jsxDEV(\"small\", {\n          className: \"text-muted\",\n          children: \"You can still resubmit before the deadline\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }, this);\n  };\n  if (isLoading || !assignment) {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5 text-center\",\n      children: /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        transition: {\n          duration: 0.5\n        },\n        children: [/*#__PURE__*/_jsxDEV(Spinner, {\n          animation: \"border\",\n          variant: \"primary\",\n          size: \"lg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-3 text-muted\",\n          children: \"Loading assignment...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    initial: {\n      opacity: 0\n    },\n    animate: {\n      opacity: 1\n    },\n    transition: {\n      duration: 0.5\n    },\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-4\",\n      children: [/*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          x: -20,\n          opacity: 0\n        },\n        animate: {\n          x: 0,\n          opacity: 1\n        },\n        transition: {\n          duration: 0.3\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline-primary\",\n          className: \"mb-4 d-flex align-items-center\",\n          onClick: () => navigate(-1),\n          children: [/*#__PURE__*/_jsxDEV(FiArrowLeft, {\n            className: \"me-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 13\n          }, this), \" Back to Assignments\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          y: -20,\n          opacity: 0\n        },\n        animate: {\n          y: 0,\n          opacity: 1\n        },\n        transition: {\n          duration: 0.4,\n          delay: 0.1\n        },\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-4 border-0 shadow-sm\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            className: \"p-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between align-items-start mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n                  className: \"h3 mb-2 text-primary\",\n                  children: [assignment.title, getStatusBadge()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Badge, {\n                  bg: assignment.type === 'quiz' ? 'primary' : 'secondary',\n                  className: \"mb-2\",\n                  children: assignment.type.toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 17\n              }, this), (submission === null || submission === void 0 ? void 0 : (_submission$grade3 = submission.grade) === null || _submission$grade3 === void 0 ? void 0 : _submission$grade3.score) != null && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-end\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h2 text-success mb-0\",\n                  children: [submission.grade.score, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 379,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"text-muted\",\n                  children: \"Your Score\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 380,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 378,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                md: 6,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex align-items-center text-muted mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(FiClock, {\n                    className: \"me-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 388,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Due:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 389,\n                    columnNumber: 21\n                  }, this), \" \", new Date(assignment.dueDate).toLocaleString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                md: 6,\n                className: \"text-md-end\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `fw-bold ${canEdit ? 'text-success' : 'text-danger'}`,\n                  children: getTimeRemaining()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 15\n            }, this), assignment.type === 'quiz' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between align-items-center mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-muted\",\n                  children: \"Progress\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 402,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-muted\",\n                  children: [Object.keys(answers).length, \"/\", assignment.questions.length, \" questions\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 401,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ProgressBar, {\n                now: getQuizProgress(),\n                variant: getQuizProgress() === 100 ? 'success' : 'primary',\n                height: 8\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), getSubmissionInfo(), !canEdit && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          scale: 0.95,\n          opacity: 0\n        },\n        animate: {\n          scale: 1,\n          opacity: 1\n        },\n        transition: {\n          duration: 0.3,\n          delay: 0.2\n        },\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"danger\",\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(FiAlertTriangle, {\n            className: \"me-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Deadline has passed!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 15\n          }, this), \" You can no longer submit or modify your answers.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 11\n      }, this), process.env.NODE_ENV === 'development' && /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"light\",\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Debug Info:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 41\n        }, this), \"Student ID: \", studentId, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 36\n        }, this), \"Has Submitted: \", hasSubmitted.toString(), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 53\n        }, this), \"Submission ID: \", (submission === null || submission === void 0 ? void 0 : submission._id) || 'None', /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 55\n        }, this), \"Can Edit: \", canEdit.toString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          y: 20,\n          opacity: 0\n        },\n        animate: {\n          y: 0,\n          opacity: 1\n        },\n        transition: {\n          duration: 0.5,\n          delay: 0.3\n        },\n        children: assignment.type === 'quiz' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"quiz-questions\",\n          children: assignment.questions.map((q, idx) => /*#__PURE__*/_jsxDEV(motion.div, {\n            initial: {\n              y: 20,\n              opacity: 0\n            },\n            animate: {\n              y: 0,\n              opacity: 1\n            },\n            transition: {\n              duration: 0.4,\n              delay: 0.1 * idx\n            },\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              className: \"mb-4 border-0 shadow-sm\",\n              children: /*#__PURE__*/_jsxDEV(Card.Body, {\n                className: \"p-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex align-items-start mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Badge, {\n                    bg: \"light\",\n                    text: \"dark\",\n                    className: \"me-3 fs-6\",\n                    children: idx + 1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 462,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Card.Subtitle, {\n                    className: \"h5 mb-0 flex-grow-1\",\n                    children: q.text\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 465,\n                    columnNumber: 25\n                  }, this), answers[q.questionId] && /*#__PURE__*/_jsxDEV(FiCheckCircle, {\n                    className: \"text-success ms-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 469,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 461,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(Row, {\n                  className: \"mt-3\",\n                  children: q.options.map((opt, i) => /*#__PURE__*/_jsxDEV(Col, {\n                    md: 6,\n                    className: \"mb-3\",\n                    children: /*#__PURE__*/_jsxDEV(motion.div, {\n                      whileHover: canEdit ? {\n                        scale: 1.02\n                      } : {},\n                      whileTap: canEdit ? {\n                        scale: 0.98\n                      } : {},\n                      children: /*#__PURE__*/_jsxDEV(Form.Check, {\n                        type: \"radio\",\n                        name: `q_${q.questionId}`,\n                        id: `${q.questionId}_${opt.key}`,\n                        className: \"custom-radio\",\n                        disabled: !canEdit,\n                        children: [/*#__PURE__*/_jsxDEV(Form.Check.Input, {\n                          type: \"radio\",\n                          checked: answers[q.questionId] === opt.key,\n                          onChange: () => handleOptionChange(q.questionId, opt.key),\n                          disabled: !canEdit\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 487,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(Form.Check.Label, {\n                          className: \"d-flex align-items-center\",\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"fw-bold me-2\",\n                            children: [opt.key, \".\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 494,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            children: opt.text\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 495,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 493,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 480,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 476,\n                      columnNumber: 29\n                    }, this)\n                  }, opt.key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 475,\n                    columnNumber: 27\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 473,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 460,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 19\n            }, this)\n          }, q.questionId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-4 border-0 shadow-sm\",\n          children: /*#__PURE__*/_jsxDEV(Card.Body, {\n            className: \"p-4\",\n            children: /*#__PURE__*/_jsxDEV(Form.Group, {\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                className: \"h5 mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(FiEdit3, {\n                  className: \"me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 512,\n                  columnNumber: 21\n                }, this), \"Your Answer\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 511,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                as: \"textarea\",\n                rows: 8,\n                value: essayContent,\n                onChange: e => setEssayContent(e.target.value),\n                disabled: !canEdit,\n                placeholder: canEdit ? \"Type your answer here...\" : \"\",\n                className: \"border-0 shadow-sm\",\n                style: {\n                  resize: 'vertical',\n                  minHeight: '200px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 515,\n                columnNumber: 19\n              }, this), canEdit && /*#__PURE__*/_jsxDEV(Form.Text, {\n                className: \"text-muted\",\n                children: [essayContent.length, \" characters\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 526,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 510,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          y: 20,\n          opacity: 0\n        },\n        animate: {\n          y: 0,\n          opacity: 1\n        },\n        transition: {\n          duration: 0.4,\n          delay: 0.5\n        },\n        className: \"text-center mt-4\",\n        children: canEdit ? /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSubmit,\n          disabled: isSubmitting,\n          size: \"lg\",\n          className: \"px-5 py-3\",\n          variant: hasSubmitted ? \"warning\" : \"success\",\n          children: isSubmitting ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Spinner, {\n              animation: \"border\",\n              size: \"sm\",\n              className: \"me-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 553,\n              columnNumber: 19\n            }, this), hasSubmitted ? 'Resubmitting...' : 'Submitting...']\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(FiSend, {\n              className: \"me-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 19\n            }, this), hasSubmitted ? 'Resubmit Assignment' : 'Submit Assignment']\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"secondary\",\n          className: \"d-inline-block\",\n          children: [/*#__PURE__*/_jsxDEV(FiAlertTriangle, {\n            className: \"me-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 15\n          }, this), \"Submission period has ended\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 564,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 537,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 338,\n    columnNumber: 5\n  }, this);\n}\n_s(QuizList, \"6WY0oQMxK8QezIbENizA7XX1yQw=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = QuizList;\nvar _c;\n$RefreshReg$(_c, \"QuizList\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","useParams","axios","motion","FiArrowLeft","FiClock","FiCheckCircle","FiAlertTriangle","FiEdit3","FiSend","Container","Card","Button","Spinner","Form","Row","Col","Badge","Alert","ProgressBar","jsxDEV","_jsxDEV","Fragment","_Fragment","QuizList","_s","_submission$grade3","navigate","assignmentId","assignment","setAssignment","submission","setSubmission","isLoading","setIsLoading","answers","setAnswers","essayContent","setEssayContent","canEdit","setCanEdit","hasSubmitted","setHasSubmitted","isSubmitting","setIsSubmitting","DEFAULT_STUDENT_ID","studentId","setStudentId","stored","localStorage","getItem","u","JSON","parse","_id","e","console","warn","fetchAssignment","resp","get","data","success","err","error","fetchSubmission","allSubs","mySub","find","s","toString","type","ansMap","forEach","ans","questionId","selectedOption","content","checkCanEdit","now","Date","due","dueDate","loadData","handleOptionChange","optionKey","prev","handleSubmit","alert","totalQuestions","questions","length","answeredQuestions","Object","keys","trim","resubmitPayload","ansArr","entries","map","qId","sel","log","response","put","message","payload","post","_err$response","_err$response$data","errorMsg","getTimeRemaining","diff","days","Math","floor","hours","getQuizProgress","getStatusBadge","_submission$grade","grade","score","bg","className","children","fileName","_jsxFileName","lineNumber","columnNumber","getSubmissionInfo","_submission$grade2","variant","submittedAt","toLocaleString","div","initial","opacity","y","animate","transition","duration","animation","size","x","onClick","delay","Body","Title","title","toUpperCase","md","height","scale","process","env","NODE_ENV","q","idx","text","Subtitle","options","opt","i","whileHover","whileTap","Check","name","id","key","disabled","Input","checked","onChange","Label","Group","Control","as","rows","value","target","placeholder","style","resize","minHeight","Text","_c","$RefreshReg$"],"sources":["C:/Users/thang/Code_WDP301/Learning-Management-System/frontend/src/components/Student/QuizList.jsx"],"sourcesContent":["// src/components/QuizList.jsx\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { motion } from \"framer-motion\";\r\nimport { FiArrowLeft, FiClock, FiCheckCircle, FiAlertTriangle, FiEdit3, FiSend } from \"react-icons/fi\";\r\nimport {\r\n  Container,\r\n  Card,\r\n  Button,\r\n  Spinner,\r\n  Form,\r\n  Row,\r\n  Col,\r\n  Badge,\r\n  Alert,\r\n  ProgressBar,\r\n} from 'react-bootstrap';\r\n\r\nexport default function QuizList() {\r\n  const navigate = useNavigate();\r\n  const { assignmentId } = useParams(); // Route: /student/quiz/:assignmentId\r\n\r\n  // 1. State\r\n  const [assignment, setAssignment] = useState(null);\r\n  const [submission, setSubmission] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [answers, setAnswers] = useState({}); // { questionId: selectedOption }\r\n  const [essayContent, setEssayContent] = useState(\"\");\r\n  const [canEdit, setCanEdit] = useState(false); // còn hạn nộp\r\n  const [hasSubmitted, setHasSubmitted] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  // Lấy studentId từ localStorage hoặc mặc định\r\n  const DEFAULT_STUDENT_ID = \"60a000000000000000000002\";\r\n  const [studentId, setStudentId] = useState(DEFAULT_STUDENT_ID);\r\n  \r\n  useEffect(() => {\r\n    try {\r\n      const stored = localStorage.getItem(\"user\");\r\n      if (stored) {\r\n        const u = JSON.parse(stored);\r\n        if (u && u._id) setStudentId(u._id);\r\n      }\r\n    } catch (e) {\r\n      console.warn(\"localStorage user parse error:\", e);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch assignment detail\r\n  const fetchAssignment = useCallback(async () => {\r\n    try {\r\n      const resp = await axios.get(`/api/student/assignments/${assignmentId}`);\r\n      if (resp.data.success) {\r\n        setAssignment(resp.data.data);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error fetching assignment:\", err);\r\n    }\r\n  }, [assignmentId]);\r\n\r\n  // Fetch submission (if có) for this student\r\n  const fetchSubmission = useCallback(async () => {\r\n    try {\r\n      // FIX: Sử dụng đúng endpoint như bạn đã chỉ định\r\n      const resp = await axios.get(\r\n        `/api/student/submissions/assignment/${assignmentId}`\r\n      );\r\n      if (resp.data.success) {\r\n        // Lọc ra submission đúng studentId\r\n        const allSubs = resp.data.data;\r\n        const mySub = allSubs.find(\r\n          (s) => s.studentId.toString() === studentId\r\n        );\r\n        if (mySub) {\r\n          setSubmission(mySub);\r\n          setHasSubmitted(true);\r\n          // Nếu quiz:\r\n          if (assignment?.type === \"quiz\" && mySub.answers) {\r\n            const ansMap = {};\r\n            mySub.answers.forEach((ans) => {\r\n              ansMap[ans.questionId] = ans.selectedOption;\r\n            });\r\n            setAnswers(ansMap);\r\n          }\r\n          // Nếu essay:\r\n          if (assignment?.type === \"essay\" && mySub.content) {\r\n            setEssayContent(mySub.content);\r\n          }\r\n        } else {\r\n          // Không tìm thấy submission -> reset state\r\n          setSubmission(null);\r\n          setHasSubmitted(false);\r\n          setAnswers({});\r\n          setEssayContent(\"\");\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error fetching submission:\", err);\r\n      // Nếu lỗi 404 hoặc không tìm thấy -> reset state\r\n      setSubmission(null);\r\n      setHasSubmitted(false);\r\n      setAnswers({});\r\n      setEssayContent(\"\");\r\n    }\r\n  }, [assignmentId, studentId, assignment?.type]);\r\n\r\n  // Kiểm tra hạn nộp\r\n  const checkCanEdit = useCallback(() => {\r\n    if (!assignment) return;\r\n    const now = new Date();\r\n    const due = new Date(assignment.dueDate);\r\n    // Nếu chưa quá hạn -> có thể nộp hoặc resubmit\r\n    setCanEdit(now <= due);\r\n  }, [assignment]);\r\n\r\n  // Kết hợp fetch và kiểm tra\r\n  useEffect(() => {\r\n    async function loadData() {\r\n      setIsLoading(true);\r\n      await fetchAssignment();\r\n      setIsLoading(false);\r\n    }\r\n    loadData();\r\n  }, [fetchAssignment]);\r\n\r\n  useEffect(() => {\r\n    if (assignment && studentId) {\r\n      checkCanEdit();\r\n      fetchSubmission();\r\n    }\r\n  }, [assignment, studentId, fetchSubmission, checkCanEdit]);\r\n\r\n  // Handle chọn đáp án quiz\r\n  const handleOptionChange = (questionId, optionKey) => {\r\n    if (!canEdit) return;\r\n    setAnswers((prev) => ({\r\n      ...prev,\r\n      [questionId]: optionKey,\r\n    }));\r\n  };\r\n\r\n  // Handle submit/resubmit\r\n  const handleSubmit = async () => {\r\n    if (!assignment || !studentId) return;\r\n\r\n    // Kiểm tra deadline một lần nữa\r\n    const now = new Date();\r\n    const due = new Date(assignment.dueDate);\r\n    if (now > due) {\r\n      alert(\"Deadline has passed. Cannot submit.\");\r\n      return;\r\n    }\r\n\r\n    // Validation cho quiz\r\n    if (assignment.type === \"quiz\") {\r\n      const totalQuestions = assignment.questions.length;\r\n      const answeredQuestions = Object.keys(answers).length;\r\n      if (answeredQuestions === 0) {\r\n        alert(\"Please answer at least one question before submitting.\");\r\n        return;\r\n      }\r\n      // Optional: require all questions to be answered\r\n      // if (answeredQuestions < totalQuestions) {\r\n      //   const confirm = window.confirm(`You have only answered ${answeredQuestions}/${totalQuestions} questions. Submit anyway?`);\r\n      //   if (!confirm) return;\r\n      // }\r\n    }\r\n\r\n    // Validation cho essay\r\n    if (assignment.type === \"essay\" && !essayContent.trim()) {\r\n      alert(\"Please write your answer before submitting.\");\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      if (hasSubmitted && submission && submission._id) {\r\n        // RESUBMIT - Update existing submission\r\n        let resubmitPayload = {};\r\n        \r\n        if (assignment.type === \"quiz\") {\r\n          // Chuyển answers thành mảng\r\n          const ansArr = Object.entries(answers).map(([qId, sel]) => ({\r\n            questionId: qId,\r\n            selectedOption: sel,\r\n          }));\r\n          resubmitPayload.answers = ansArr;\r\n        } else {\r\n          // essay\r\n          resubmitPayload.content = essayContent.trim();\r\n        }\r\n\r\n        console.log(\"Resubmitting with payload:\", resubmitPayload);\r\n        console.log(\"Submission ID:\", submission._id);\r\n\r\n        // FIX: Sử dụng đúng endpoint resubmit\r\n        const response = await axios.put(\r\n          `/api/student/submissions/resubmit/${submission._id}`, \r\n          resubmitPayload\r\n        );\r\n        \r\n        console.log(\"Resubmit response:\", response.data);\r\n        \r\n        if (response.data.success) {\r\n          alert(\"Resubmission successful!\");\r\n          // Refresh lại submission để lấy dữ liệu mới\r\n          await fetchSubmission();\r\n        } else {\r\n          alert(response.data.message || \"Resubmission failed!\");\r\n        }\r\n        \r\n      } else {\r\n        // NEW SUBMISSION - Create new submission\r\n        let payload = {\r\n          studentId,\r\n          assignmentId,\r\n        };\r\n        \r\n        if (assignment.type === \"quiz\") {\r\n          // Chuyển answers thành mảng\r\n          const ansArr = Object.entries(answers).map(([qId, sel]) => ({\r\n            questionId: qId,\r\n            selectedOption: sel,\r\n          }));\r\n          payload.answers = ansArr;\r\n        } else {\r\n          // essay\r\n          payload.content = essayContent.trim();\r\n        }\r\n\r\n        console.log(\"New submission with payload:\", payload);\r\n\r\n        const response = await axios.post(\"/api/student/submissions/submit\", payload);\r\n        \r\n        console.log(\"Submit response:\", response.data);\r\n        \r\n        if (response.data.success) {\r\n          alert(\"Submission successful!\");\r\n          // Set hasSubmitted và submission data\r\n          setHasSubmitted(true);\r\n          if (response.data.data) {\r\n            setSubmission(response.data.data);\r\n          }\r\n          // Refresh lại submission để đảm bảo\r\n          await fetchSubmission();\r\n        } else {\r\n          alert(response.data.message || \"Submission failed!\");\r\n        }\r\n      }\r\n      \r\n    } catch (err) {\r\n      console.error(\"Submit error:\", err);\r\n      const errorMsg = err.response?.data?.message || err.message || \"Failed to submit.\";\r\n      alert(errorMsg);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Helper functions\r\n  const getTimeRemaining = () => {\r\n    if (!assignment) return null;\r\n    const now = new Date();\r\n    const due = new Date(assignment.dueDate);\r\n    const diff = due - now;\r\n    \r\n    if (diff <= 0) return \"Overdue\";\r\n    \r\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\r\n    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n    \r\n    if (days > 0) return `${days} day${days > 1 ? 's' : ''} remaining`;\r\n    if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} remaining`;\r\n    return \"Less than 1 hour remaining\";\r\n  };\r\n\r\n  const getQuizProgress = () => {\r\n    if (!assignment || assignment.type !== 'quiz') return 0;\r\n    const totalQuestions = assignment.questions.length;\r\n    const answeredQuestions = Object.keys(answers).length;\r\n    return totalQuestions > 0 ? (answeredQuestions / totalQuestions) * 100 : 0;\r\n  };\r\n\r\n  const getStatusBadge = () => {\r\n    if (hasSubmitted && submission?.grade?.score != null) {\r\n      return <Badge bg=\"success\" className=\"ms-2\"><FiCheckCircle className=\"me-1\" />Graded</Badge>;\r\n    }\r\n    if (hasSubmitted) {\r\n      return <Badge bg=\"info\" className=\"ms-2\"><FiCheckCircle className=\"me-1\" />Submitted</Badge>;\r\n    }\r\n    if (!canEdit) {\r\n      return <Badge bg=\"danger\" className=\"ms-2\"><FiAlertTriangle className=\"me-1\" />Overdue</Badge>;\r\n    }\r\n    return <Badge bg=\"warning\" className=\"ms-2\"><FiClock className=\"me-1\" />In Progress</Badge>;\r\n  };\r\n\r\n  // Show last submission info\r\n  const getSubmissionInfo = () => {\r\n    if (!hasSubmitted || !submission) return null;\r\n    \r\n    return (\r\n      <Alert variant=\"info\" className=\"mb-4\">\r\n        <div className=\"d-flex justify-content-between align-items-center\">\r\n          <div>\r\n            <strong>Last submitted:</strong> {new Date(submission.submittedAt).toLocaleString()}\r\n            {submission.grade?.score != null && (\r\n              <span className=\"ms-3\">\r\n                <strong>Grade:</strong> <span className=\"text-success\">{submission.grade.score}%</span>\r\n              </span>\r\n            )}\r\n          </div>\r\n          {canEdit && (\r\n            <small className=\"text-muted\">You can still resubmit before the deadline</small>\r\n          )}\r\n        </div>\r\n      </Alert>\r\n    );\r\n  };\r\n\r\n  if (isLoading || !assignment) {\r\n    return (\r\n      <Container className=\"py-5 text-center\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.5 }}\r\n        >\r\n          <Spinner animation=\"border\" variant=\"primary\" size=\"lg\" />\r\n          <p className=\"mt-3 text-muted\">Loading assignment...</p>\r\n        </motion.div>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      transition={{ duration: 0.5 }}\r\n    >\r\n      <Container className=\"py-4\">\r\n        {/* Back Button */}\r\n        <motion.div\r\n          initial={{ x: -20, opacity: 0 }}\r\n          animate={{ x: 0, opacity: 1 }}\r\n          transition={{ duration: 0.3 }}\r\n        >\r\n          <Button\r\n            variant=\"outline-primary\"\r\n            className=\"mb-4 d-flex align-items-center\"\r\n            onClick={() => navigate(-1)}\r\n          >\r\n            <FiArrowLeft className=\"me-2\" /> Back to Assignments\r\n          </Button>\r\n        </motion.div>\r\n\r\n        {/* Assignment Header */}\r\n        <motion.div\r\n          initial={{ y: -20, opacity: 0 }}\r\n          animate={{ y: 0, opacity: 1 }}\r\n          transition={{ duration: 0.4, delay: 0.1 }}\r\n        >\r\n          <Card className=\"mb-4 border-0 shadow-sm\">\r\n            <Card.Body className=\"p-4\">\r\n              <div className=\"d-flex justify-content-between align-items-start mb-3\">\r\n                <div>\r\n                  <Card.Title className=\"h3 mb-2 text-primary\">\r\n                    {assignment.title}\r\n                    {getStatusBadge()}\r\n                  </Card.Title>\r\n                  <Badge bg={assignment.type === 'quiz' ? 'primary' : 'secondary'} className=\"mb-2\">\r\n                    {assignment.type.toUpperCase()}\r\n                  </Badge>\r\n                </div>\r\n                {submission?.grade?.score != null && (\r\n                  <div className=\"text-end\">\r\n                    <div className=\"h2 text-success mb-0\">{submission.grade.score}%</div>\r\n                    <small className=\"text-muted\">Your Score</small>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <Row>\r\n                <Col md={6}>\r\n                  <div className=\"d-flex align-items-center text-muted mb-2\">\r\n                    <FiClock className=\"me-2\" />\r\n                    <strong>Due:</strong> {new Date(assignment.dueDate).toLocaleString()}\r\n                  </div>\r\n                </Col>\r\n                <Col md={6} className=\"text-md-end\">\r\n                  <div className={`fw-bold ${canEdit ? 'text-success' : 'text-danger'}`}>\r\n                    {getTimeRemaining()}\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n\r\n              {assignment.type === 'quiz' && (\r\n                <div className=\"mt-3\">\r\n                  <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                    <span className=\"text-muted\">Progress</span>\r\n                    <span className=\"text-muted\">{Object.keys(answers).length}/{assignment.questions.length} questions</span>\r\n                  </div>\r\n                  <ProgressBar \r\n                    now={getQuizProgress()} \r\n                    variant={getQuizProgress() === 100 ? 'success' : 'primary'}\r\n                    height={8}\r\n                  />\r\n                </div>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        {/* Submission Info */}\r\n        {getSubmissionInfo()}\r\n\r\n        {/* Deadline Alert */}\r\n        {!canEdit && (\r\n          <motion.div\r\n            initial={{ scale: 0.95, opacity: 0 }}\r\n            animate={{ scale: 1, opacity: 1 }}\r\n            transition={{ duration: 0.3, delay: 0.2 }}\r\n          >\r\n            <Alert variant=\"danger\" className=\"mb-4\">\r\n              <FiAlertTriangle className=\"me-2\" />\r\n              <strong>Deadline has passed!</strong> You can no longer submit or modify your answers.\r\n            </Alert>\r\n          </motion.div>\r\n        )}\r\n\r\n        {/* Debug Info - Remove in production */}\r\n        {process.env.NODE_ENV === 'development' && (\r\n          <Alert variant=\"light\" className=\"mb-4\">\r\n            <strong>Debug Info:</strong><br/>\r\n            Student ID: {studentId}<br/>\r\n            Has Submitted: {hasSubmitted.toString()}<br/>\r\n            Submission ID: {submission?._id || 'None'}<br/>\r\n            Can Edit: {canEdit.toString()}\r\n          </Alert>\r\n        )}\r\n\r\n        {/* Content */}\r\n        <motion.div\r\n          initial={{ y: 20, opacity: 0 }}\r\n          animate={{ y: 0, opacity: 1 }}\r\n          transition={{ duration: 0.5, delay: 0.3 }}\r\n        >\r\n          {assignment.type === 'quiz' ? (\r\n            <div className=\"quiz-questions\">\r\n              {assignment.questions.map((q, idx) => (\r\n                <motion.div\r\n                  key={q.questionId}\r\n                  initial={{ y: 20, opacity: 0 }}\r\n                  animate={{ y: 0, opacity: 1 }}\r\n                  transition={{ duration: 0.4, delay: 0.1 * idx }}\r\n                >\r\n                  <Card className=\"mb-4 border-0 shadow-sm\">\r\n                    <Card.Body className=\"p-4\">\r\n                      <div className=\"d-flex align-items-start mb-3\">\r\n                        <Badge bg=\"light\" text=\"dark\" className=\"me-3 fs-6\">\r\n                          {idx + 1}\r\n                        </Badge>\r\n                        <Card.Subtitle className=\"h5 mb-0 flex-grow-1\">\r\n                          {q.text}\r\n                        </Card.Subtitle>\r\n                        {answers[q.questionId] && (\r\n                          <FiCheckCircle className=\"text-success ms-2\" />\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <Row className=\"mt-3\">\r\n                        {q.options.map((opt, i) => (\r\n                          <Col md={6} key={opt.key} className=\"mb-3\">\r\n                            <motion.div\r\n                              whileHover={canEdit ? { scale: 1.02 } : {}}\r\n                              whileTap={canEdit ? { scale: 0.98 } : {}}\r\n                            >\r\n                              <Form.Check\r\n                                type=\"radio\"\r\n                                name={`q_${q.questionId}`}\r\n                                id={`${q.questionId}_${opt.key}`}\r\n                                className=\"custom-radio\"\r\n                                disabled={!canEdit}\r\n                              >\r\n                                <Form.Check.Input\r\n                                  type=\"radio\"\r\n                                  checked={answers[q.questionId] === opt.key}\r\n                                  onChange={() => handleOptionChange(q.questionId, opt.key)}\r\n                                  disabled={!canEdit}\r\n                                />\r\n                                <Form.Check.Label className=\"d-flex align-items-center\">\r\n                                  <span className=\"fw-bold me-2\">{opt.key}.</span>\r\n                                  <span>{opt.text}</span>\r\n                                </Form.Check.Label>\r\n                              </Form.Check>\r\n                            </motion.div>\r\n                          </Col>\r\n                        ))}\r\n                      </Row>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </motion.div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <Card className=\"mb-4 border-0 shadow-sm\">\r\n              <Card.Body className=\"p-4\">\r\n                <Form.Group>\r\n                  <Form.Label className=\"h5 mb-3\">\r\n                    <FiEdit3 className=\"me-2\" />\r\n                    Your Answer\r\n                  </Form.Label>\r\n                  <Form.Control\r\n                    as=\"textarea\"\r\n                    rows={8}\r\n                    value={essayContent}\r\n                    onChange={(e) => setEssayContent(e.target.value)}\r\n                    disabled={!canEdit}\r\n                    placeholder={canEdit ? \"Type your answer here...\" : \"\"}\r\n                    className=\"border-0 shadow-sm\"\r\n                    style={{ resize: 'vertical', minHeight: '200px' }}\r\n                  />\r\n                  {canEdit && (\r\n                    <Form.Text className=\"text-muted\">\r\n                      {essayContent.length} characters\r\n                    </Form.Text>\r\n                  )}\r\n                </Form.Group>\r\n              </Card.Body>\r\n            </Card>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* Submit Button */}\r\n        <motion.div\r\n          initial={{ y: 20, opacity: 0 }}\r\n          animate={{ y: 0, opacity: 1 }}\r\n          transition={{ duration: 0.4, delay: 0.5 }}\r\n          className=\"text-center mt-4\"\r\n        >\r\n          {canEdit ? (\r\n            <Button \r\n              onClick={handleSubmit}\r\n              disabled={isSubmitting}\r\n              size=\"lg\"\r\n              className=\"px-5 py-3\"\r\n              variant={hasSubmitted ? \"warning\" : \"success\"}\r\n            >\r\n              {isSubmitting ? (\r\n                <>\r\n                  <Spinner animation=\"border\" size=\"sm\" className=\"me-2\" />\r\n                  {hasSubmitted ? 'Resubmitting...' : 'Submitting...'}\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <FiSend className=\"me-2\" />\r\n                  {hasSubmitted ? 'Resubmit Assignment' : 'Submit Assignment'}\r\n                </>\r\n              )}\r\n            </Button>\r\n          ) : (\r\n            <Alert variant=\"secondary\" className=\"d-inline-block\">\r\n              <FiAlertTriangle className=\"me-2\" />\r\n              Submission period has ended\r\n            </Alert>\r\n          )}\r\n        </motion.div>\r\n      </Container>\r\n    </motion.div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}